{{ """" }}
#
# OpenTelemetry collector configuration generated by Ansible.  This file
# uses the `observability_backend` variable to choose which OTLP
# endpoint to send traces and metrics to.  Supported backends are
# Grafana, Elasticsearch and OpenSearch.  Override the endpoint
# variables (grafana_otlp_endpoint, elasticsearch_otlp_endpoint,
# opensearch_otlp_endpoint) as needed via inventory or extra vars.

receivers:
  otlp:
    protocols:
      grpc: {}
      http: {}

exporters:
  otlp:
    endpoint: "{{ grafana_otlp_endpoint if observability_backend == 'grafana' else (elasticsearch_otlp_endpoint if observability_backend == 'elasticsearch' else opensearch_otlp_endpoint) }}"
    insecure: true

service:
  pipelines:
    traces:
      receivers: [otlp]
      exporters: [otlp]
    metrics:
      receivers: [otlp]
      exporters: [otlp]